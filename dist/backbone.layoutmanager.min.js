/* backbone.layoutmanager.js v0.0.0
 * Copyright 2011, Tim Branyen (@tbranyen)
 * backbone.layoutmanager.js may be freely distributed under the MIT license.
 */(function(){"use strict";var a=Backbone.LayoutManager=Backbone.View.extend({initialize:function(a){var b={};_.isFunction(this.partials)?_.extend(b,this.partials.call(this)):_.isObject(this.partials)&&_.extend(b,this.partials),this.partials=b,_.bindAll(this),this.options=_.extend({},Backbone.LayoutManager,this.options),_.isFunction(this.options.initialize)&&this.options.initialize.apply(this,arguments)},render:function(b){function j(c){a.cache(e,c),f.el.innerHTML=c,_.each(f.partials,function(a,b){a.render(i).then(function(a){g.partial(f.el,b,a)})}),b(f.el)}function i(b){function e(c,d){a.cache(f,c),b.el.innerHTML=g.render.call(g,c,d),i.resolve(b.el)}var f,i=h(e);return{render:function(h){!h&&_.isFunction(b.serialize)&&(h=b.serialize.call(b)),d=g.paths&&g.paths.template||"",f=d+b.template;if(c=a.cache(f)){e(c,h,f);return i}c=g.fetch.call(i,d+b.template),c&&e(c,h);return i}}}function h(a){var b=new $.Deferred;b.async=function(){return a};return b}var c,d,e,f=this,g=this.options;d=g.paths&&g.paths.layout||"",e=d+g.name;if(c=a.cache(e))return j(c);c=g.fetch.call(h(j),e);if(c)return j(c)}},{_cache:{},cache:function(a,b){if(a in this._cache)return this._cache[a];if(a!=null&&b!=null)return this._cache[a]=b},configure:function(a){var b=Backbone.LayoutManager.prototype.options;_.isObject(a)&&(Backbone.LayoutManager.prototype.options=_.extend(b,a))}});Backbone.LayoutManager.prototype.options={paths:{},fetch:function(a){var b=this.async();$.get(a,function(a){b(a)})},partial:function(a,b,c){$(a).find(b).html(c)},render:_.identity}}).call(this)